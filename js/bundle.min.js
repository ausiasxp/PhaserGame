const STAGE_WIDTH=800,STAGE_HEIGHT=600,FREQUENCY=1e3/30;let squirrelWelcome,initialState={preload:loadAssets,create:displayScreen};function loadAssets(){game.load.image("bg","assets/images/welcomeBG.png"),game.load.image("playButton","assets/images/button_play.png"),game.load.image("aboutButton","assets/images/button_about.png"),game.load.image("title","assets/images/game-name.png"),game.load.image("rect","assets/images/rectangle_about.png"),game.load.spritesheet("squirrel","assets/images/squirrelWelcome.png",32,32),game.load.image("ground","assets/images/ground.png")}function displayScreen(){let bg;game.input.enabled=!0,game.add.image(0,0,"bg").height=600;let rect=game.add.image(-10,120,"rect"),title;rect.height=100,rect.width=830,rect.alpha=.8,game.add.image(400,170,"title").anchor.setTo(.5,.5),squirrelWelcome=game.add.sprite(70,530,"squirrel",0),squirrelWelcome.anchor.setTo(.5,1),squirrelWelcome.scale.setTo(2.5),squirrelWelcome.smoothed=!1,squirrelWelcome.animations.add("walk",[32,33,34],10,!0),game.add.tileSprite(0,squirrelWelcome.y-16,800,100,"ground"),showAuthors(),showButtons()}function showAuthors(){let msgAuthors="Ausias García Torres\nVanessa Jiménez Tarazona\nJosaem Silva Sanmiguel",styleAuthors={font:"12pt Sniglet",fill:"#FFFFFF"},authorsTxt=game.add.text(600,500,msgAuthors,styleAuthors);authorsTxt.fixedToCamera=!0,authorsTxt.stroke="#000000",authorsTxt.strokeThickness=3,authorsTxt.fill="#ffffff"}function showButtons(){let btnPlay=game.add.button(400,300,"playButton",onPlayButtonPressed),btnAbout;btnPlay.anchor.setTo(.5,.5),game.add.button(btnPlay.x,btnPlay.y+btnPlay.height+30,"aboutButton",onAboutButtonPressed).anchor.setTo(.5,.5)}function onAboutButtonPressed(){game.state.start("about")}function onPlayButtonPressed(){game.time.events.loop(1e3/30,moveSquirrel,this),squirrelWelcome.animations.play("walk")}function moveSquirrel(){squirrelWelcome.x+=10,squirrelWelcome.x>800&&game.state.start("play")}let endState={preload:loadEnd,create:createEnd};function loadEnd(){game.load.image("bg","assets/images/welcomeBG.png"),game.load.spritesheet("energySS","assets/images/energyUI.png",88,64),game.load.spritesheet("jumpsSS","assets/images/jumpsUI.png",96,64),game.load.image("textBg","assets/images/rectangle_about.png"),game.load.image("homeBtn","assets/images/button_home.png"),game.load.image("replayBtn","assets/images/button_play-again.png"),game.load.image("nutHUD","assets/images/nutsHUD.png")}function createEnd(){bg=game.add.image(0,0,"bg"),bg.width=800,bg.height=600;let rect=game.add.image(400,15,"textBg");rect.anchor.setTo(.5,0),rect.alpha=.8,rect.width=770,rect.height=530;let subtitlesTxt="Total time:\n\nRemaining jumps:\nRemaining energy:\nWords score:\nNuts collected:\n\nTotal score:",subtitles=game.add.text(200,60,subtitlesTxt,{fontSize:"20pt",font:font_time});subtitles.anchor.setTo(0,0),subtitles.stroke="#000000",subtitles.strokeThickness=8,subtitles.fill="#ffffff",subtitles.smoothed=!1;let time_text=String(Math.trunc(total_time/60)).padStart(2,"0")+":"+String(total_time%60).padStart(2,"0"),time=game.add.text(600,60,time_text,{fontSize:"20pt",font:font_time}),jumps,energy;time.anchor.setTo(1,0),time.stroke="#000000",time.strokeThickness=8,time.fill="#ffffff",time.smoothed=!1,game.add.image(600,120,"jumpsSS",currentJump).anchor.setTo(1,0),game.add.image(600,180,"energySS",EnergyValue).anchor.setTo(1,0);let wordScore=game.add.text(600,240,scorePalabras,{fontSize:"20pt",font:font_time});wordScore.anchor.setTo(1,0),wordScore.stroke="#000000",wordScore.strokeThickness=8,wordScore.fill="#ffffff",wordScore.smoothed=!1;let nutImg=game.add.image(580,300,"nutHUD");nutImg.anchor.setTo(1,0),nutImg.scale.setTo(.7);let totalNuts=game.add.text(600,320,"x"+scoreNut,{fontSize:"20pt",font:font_time});totalNuts.anchor.setTo(1,0),totalNuts.stroke="#000000",totalNuts.strokeThickness=8,totalNuts.fill="#ffffff",totalNuts.smoothed=!1;let totalScore=EnergyValue+currentJump+scorePalabras+scoreNut,totalScoreTxt=game.add.text(600,390,totalScore,{fontSize:"20pt",font:font_time}),homeBtn,replayBtn;totalScoreTxt.anchor.setTo(1,0),totalScoreTxt.stroke="#000000",totalScoreTxt.strokeThickness=8,totalScoreTxt.fill="#ffffff",totalScoreTxt.smoothed=!1,game.add.button(200,480,"homeBtn",returnHome).anchor.setTo(.5,.5),game.add.button(600,480,"replayBtn",replay).anchor.setTo(.5,.5),gameState=PLATFORMER,total_time=0,currentJump=MAX_JUMPS,EnergyValue=MAX_ENERGY,squirrel_initial_x=GLOBAL_INITAL_X,squirrel_initial_y=WORLD_HEIGHT-150,music=!1,music2=!1,music3=!1,soundMusic.destroy(),soundMusic2.destroy(),soundMusic3.destroy(),nutsTimer=NUTS_SECONDS}function returnHome(){game.state.start("welcome")}function replay(){game.state.start("play")}const game_name="nut catcher",font_instructions="bold sketchtica",font_title="orange_juice";let aboutState={preload:loadAboutAssets,create:showInstructions};function loadAboutAssets(){game.load.image("backButton","assets/images/button_back.png"),game.load.image("textBg","assets/images/rectangle_about.png")}function showInstructions(){bg=game.add.image(0,0,"bg"),bg.width=800,bg.height=600;let rect=game.add.image(400,15,"textBg");rect.anchor.setTo(.5,0),rect.alpha=.8,rect.width=770,rect.height=470;let textTitle=game_name,styleTitle={font:font_title,fontSize:"60pt",fill:"#521b00"},title;game.add.text(400,80,textTitle,styleTitle).anchor.setTo(.5,.5);let instructions="Control the squirrel with the arrow keys.";instructions+="\nHelp the squirrel through its way home.",instructions+="\nYou have to jump over branches, try not to get eaten by predators. If you get eaten, your energy will be decreased by one.",instructions+=" Guess different types of nuts to sum up points. And finally collect all the nuts you can. (Don't let those sneaky spiders steal your precious nuts)";let instrucText=game.add.text(0,0,instructions,{font:"bold sketchtica",fontSize:"20pt",fill:"#240c00"}),btnBack;instrucText.setTextBounds(30,250,750),instrucText.boundsAlignH="center",instrucText.boundsAlignV="middle",instrucText.wordWrap=!0,instrucText.wordWrapWidth=740,instrucText.smoothed=!1,game.add.button(400,540,"backButton",onBackButtonPressed).anchor.setTo(.5,.5)}function onBackButtonPressed(){game.state.start("welcome")}function loadPlayAssetsAvoidEnemies(){loadSprites(),loadImages(),loadSounds()}function loadSprites(){game.load.spritesheet("eagleSpriteSheet","assets/images/bird_2_eagleSS.png",84,108),game.load.spritesheet("squirrelSpritesheet","assets/images/squirrel.png",64,52),game.load.spritesheet("foxSpritesheet","assets/images/fox.png",160,160),game.load.spritesheet("HUDenergy","assets/images/energyUI.png",88,64)}function loadImages(){game.load.image("ground","assets/images/ground.png"),game.load.image("fox","/assets/images/fox.png"),game.load.image("gameOver","assets/images/gameOver.png"),game.load.image("playButton","assets/images/button_play.png"),game.load.image("platform1","assets/images/platform1.png"),game.load.image("platform2","assets/images/platform2.png"),game.load.image("platform3","assets/images/platform3.png"),game.load.image("platform4","assets/images/platform4.png"),game.load.image("platform5","assets/images/platform5.png")}function loadSounds(){game.load.audio("foxCall","assets/sounds/fox.mp3")}function createPlayAvoidEnemies(){createEagles(EAGLES_GROUP_SIZE),createFoxes(FOXES_GROUP_SIZE)}function createEagles(number){eagles=game.add.group(),eagles.enableBody=!0,eagles.createMultiple(number,"eagleSpriteSheet"),eagles.callAll("animations.add","animations","fly",[0,1,2],8,!0),eagles.callAll("events.onOutOfBounds.add","events.onOutOfBounds",resetMember),eagles.callAll("anchor.setTo","anchor",.5,1),eagles.setAll("checkWorldBounds",!0),currentEagleProbability=EAGLE_PROBABILITY,currentEagleVelocity=EAGLE_VELOCITY,game.time.events.loop(TIMER_RYTHM,activateEagle,this)}function activateEagle(){if(gameState==AVOID_ENEMIES&&Math.random()<currentEagleProbability){let eagle=eagles.getFirstExists(!1);if(eagle){let gh=600,uh=eagle.body.height,h=gh-uh,y,z=uh/2+Math.floor(Math.random()*h),x=Math.max(squirrel.body.x+400,800);eagle.reset(x,z),eagle.body.velocity.x=-currentEagleVelocity;let velY=1==Math.round(Math.random())?70:-70;eagle.body.velocity.y=velY,eagle.animations.play("fly")}}}function createFoxes(number){foxes=game.add.group(),foxes.enableBody=!0,foxes.createMultiple(number,"foxSpritesheet"),foxes.callAll("animations.add","animations","walk",[26,27,28,29,30,31,32,33],8,!0),foxes.callAll("animations.add","animations","jump",[42,43,44],3,!1),foxes.callAll("events.onOutOfBounds.add","events.onOutOfBounds",resetMember),foxes.callAll("body.setSize","body",100,80,30,80),game.physics.arcade.enable(foxes),foxes.setAll("body.gravity.y",GRAVITY),foxes.callAll("anchor.setTo","anchor",.5,1),foxes.setAll("body.checkWorldBounds",!0),game.time.events.loop(TIMER_RYTHM,activateFoxes,this)}function resetMember(item){item.kill()}function activateFoxes(){if(gameState==AVOID_ENEMIES&&Math.random()<FOXES_PROBABILITY){let fox=foxes.getFirstExists(!1);if(fox){let x=Math.max(squirrel.body.x+400,800);fox.reset(x,WORLD_HEIGHT-80),fox.body.velocity.x=-FOXES_VELOCITY,fox.animations.play("walk")}}}const WORLD_WIDTH=10500,WORLD_HEIGHT=900,GRAVITY=1e3,JUMP=600,SQUIRREL_VELOCITY=300,font_sign="Sniglet",font_time="sniglet",GLOBAL_INITAL_X=32,PLATFORMER=0,AVOID_ENEMIES=1,WORD_GAME=2,NUT_CATCHER=3,END=4,VICTORY_POINTS=500,PLATFORM_X_OFFSET=20,PLATFORM_VELOCITY=75,BUSH_HEIGHT=990,MAX_JUMPS=35,LEVEL_X_ORIGIN=4355,TIMER_RYTHM=2*Phaser.Timer.SECOND,MAX_ENERGY=6,EAGLES_GROUP_SIZE=10,EAGLE_PROBABILITY=.5,EAGLE_VELOCITY=70,FOXES_GROUP_SIZE=10,FOXES_PROBABILITY=.5,FOXES_VELOCITY=200,FOXES_VELOCITY_Y=800,PLAYER_COLLIDE_OFFSET_X=200,TIEMPO_PALABRAS=40,SPIDER_PROBABILITY=.3,NUTS_SECONDS=30;let gameState=PLATFORMER,squirrel,bg_back,bg_mid,bg_light,bg_front,platforms,ground,toRight=!1,cursors,spacebarKey,soundMusic,music=!1,soundMusic2,music2=!1,soundMusic3,music3=!1,squirrel_initial_x=GLOBAL_INITAL_X,squirrel_initial_y=WORLD_HEIGHT-150,total_time=0,total_timeHUD,total_time_clock,bgplatformBehind,bgplatformInfront,score=0,scoreText,soundJump,currentJump=MAX_JUMPS,WallAB,jumpsHUD,sign,signGroup,rect,signText,signTextContainer,movingPlat,EnergyValue=MAX_ENERGY,eagles,currentEagleProbability,currentEagleVelocity,foxes,foxCall,energyHUD,gameOverImg,replayButton,cry,wordFound=!1,wordsFound=0,wordFoundText,word="",wordText,palabraActual,indicePalabra,charText;var timerPalabras,timerTextPalabras,timeRemaining=40,scorePalabras=0,scorePalabrasText,imagenPalabra;let wrongSF,correctSF,rectBGwords,foundTxt,timeTxt,scoreTxt,fallingNut,generadorNut,firsNut,scoreNut,scoreNutHUD,nutHUD,nutSnd,droppedSnd,fallingSpider,nutsTimer=NUTS_SECONDS,nutsTimerTxt,playState={preload:loadPlayAssets,create:createPlay,update:updatePlay},game;function loadPlayAssets(){game.load.image("bg_back","assets/images/parallax-forest-back-trees.png"),game.load.image("bg_mid","assets/images/parallax-forest-middle-trees.png"),game.load.image("bg_light","assets/images/parallax-forest-lights.png"),game.load.image("bg_front","assets/images/parallax-forest-front-trees.png"),game.load.image("groundr","assets/images/platform.png"),game.load.image("groundl","assets/images/platformleft.png"),game.load.image("sign","assets/images/signpost.png"),game.load.image("star","assets/images/star.png"),game.load.image("tree","assets/images/tree3.png"),game.load.image("tree2","assets/images/tree2.png"),game.load.image("bush","assets/images/bush.png"),game.load.image("signTextBg","assets/images/rectangle_about.png"),game.load.audio("jump","assets/sounds/jump_04.wav"),game.load.audio("music","assets/sounds/music.wav"),game.load.audio("music2","assets/sounds/music2.ogg"),game.load.audio("music3","assets/sounds/music3.mp3"),game.load.spritesheet("jumpsHUD","assets/images/jumpsUI.png",96,64),loadPlayAssetsAvoidEnemies(),game.load.audio("cry","assets/sounds/cry.mp3"),game.load.image("cashew","assets/images/cashew.png"),game.load.image("almond","assets/images/almond.png"),game.load.image("hazelnut","assets/images/hazelnut.png"),game.load.image("peanut","assets/images/peanut.png"),game.load.image("pistachio","assets/images/pistachio.png"),game.load.image("pumpkin seed","assets/images/pumpkin_seeds.png"),game.load.image("sunflower seed","assets/images/sunflower_seeds.png"),game.load.image("walnut","assets/images/walnut.png"),game.load.audio("wrong","assets/sounds/wrong.mp3"),game.load.audio("correct","assets/sounds/correct.mp3"),game.load.image("nutHUD","assets/images/nutsHUD.png"),game.load.audio("nutCatched","assets/sounds/nutCatched.wav"),game.load.spritesheet("spider","assets/images/Spider Sprite Sheet.png",32,32),game.load.audio("dropped","assets/sounds/droppedNut.wav")}function createPlay(){game.world.setBounds(0,0,10500,WORLD_HEIGHT),createBG(),cursors=game.input.keyboard.createCursorKeys(),spacebarKey=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),setPlatformsBehind(),ground=game.add.tileSprite(0,game.world.height-64,game.world.width,100,"ground"),game.physics.arcade.enable(ground),ground.body.immovable=!0,createSign(),setSquirrel(),game.camera.follow(squirrel,Phaser.Camera.FOLLOW_LOCKON,.1,.1),createPlayAvoidEnemies(),setPlatformsInfront(),soundMusic=game.add.audio("music",1,!0),soundMusic2=game.add.audio("music2",2,!0),soundMusic3=game.add.audio("music3",2,!0),soundJump=game.add.audio("jump",.6),foxCall=game.add.audio("foxCall"),cry=game.add.audio("cry"),nutSnd=game.add.audio("nutCatched",.7),droppedSnd=game.add.audio("dropped",.7);let allX=50;for(i in jumpsHUD=game.add.sprite(50,50,"jumpsHUD",currentJump),jumpsHUD.anchor.setTo(.5,.5),jumpsHUD.fixedToCamera=!0,energyHUD=game.add.sprite(50,jumpsHUD.y+jumpsHUD.height+10,"HUDenergy",6),energyHUD.anchor.setTo(.5,.5),energyHUD.fixedToCamera=!0,total_time_clock=game.time.events.loop(Phaser.Timer.SECOND,updateTime,this),total_timeHUD=game.add.text(50,energyHUD.y+energyHUD.height+10,total_time,{fontSize:"20pt",font:font_time}),total_timeHUD.anchor.setTo(.5,.5),total_timeHUD.fixedToCamera=!0,total_timeHUD.stroke="#000000",total_timeHUD.strokeThickness=8,total_timeHUD.fill="#ffffff",wordText=game.add.text(30,30,"",{fill:"#000000"}),wordFoundText=game.add.text(30,60,"",{fill:"#000000"}),charText=game.add.text(30,150,"",{fill:"#000000"}),charText.fixedToCamera=!0,timerTextPalabras=game.add.text(200,30,"",{fill:"#000000"}),scorePalabrasText=game.add.text(300,70,"",{fill:"#000000"}),(timerPalabras=game.time.create(!1)).loop(1e3,updateCounter,this),timerPalabras.start(),game.input.keyboard.addCallbacks(this,keyPress,null,null),rectBGwords=game.add.image(100,30,"signTextBg"),rectBGwords.alpha=.8,rectBGwords.fixedToCamera=!0,rectBGwords.width=670,rectBGwords.height=460,rectBGwords.visible=!1,imagenPalabra=game.add.sprite(0,1200,"almond"),mostrarImagenPalabra("almond"),misPalabras=["cashew","almond","hazelnut","peanut","pistachio","pumpkin seed","sunflower seed","walnut"],misPalabras)misPalabras[i]=[misPalabras[i],!1];palabraActual=nuevaPalabra(misPalabras),wordsFound=0,scorePalabras=0,wrongSF=game.add.audio("wrong"),correctSF=game.add.audio("correct"),foundTxt=game.add.text(150,80,"found",{fontSize:"10pt",font:font_time}),foundTxt.fixedToCamera=!0,foundTxt.anchor.setTo(.5,0),foundTxt.stroke="#000000",foundTxt.strokeThickness=3,foundTxt.fill="#ffffff",foundTxt.visible=!1,timeTxt=game.add.text(730,85,"time",{fontSize:"10pt",font:font_time}),timeTxt.fixedToCamera=!0,timeTxt.anchor.setTo(.5,0),timeTxt.stroke="#000000",timeTxt.strokeThickness=3,timeTxt.fill="#ffffff",timeTxt.visible=!1,scoreTxt=game.add.text(400,85,"score",{fontSize:"10pt",font:font_time}),scoreTxt.fixedToCamera=!0,scoreTxt.anchor.setTo(.5,0),scoreTxt.stroke="#000000",scoreTxt.strokeThickness=3,scoreTxt.fill="#ffffff",scoreTxt.visible=!1,fallingNut=game.add.sprite(-10,WORLD_HEIGHT+50,"star"),fallingNut.scale.setTo(.5),fallingSpider=game.add.sprite(-10,WORLD_HEIGHT+50,"spider",27),fallingSpider.scale.setTo(3),firsNut=!0,scoreNut=0,gameState=PLATFORMER,nutHUD=game.add.image(50,250,"nutHUD"),nutHUD.fixedToCamera=!0,nutHUD.scale.setTo(.7),nutHUD.anchor.setTo(.5,.5),scoreNutHUD=game.add.text(70,270,"x"+scoreNut,{fontSize:"20pt",font:font_time}),scoreNutHUD.anchor.setTo(.5,.5),scoreNutHUD.fixedToCamera=!0,scoreNutHUD.stroke="#000000",scoreNutHUD.strokeThickness=8,scoreNutHUD.fill="#ffffff",nutsTimerTxt=game.add.text(740,30,String(nutsTimer).padStart(2,"0"),{fontSize:"20pt",font:font_time}),nutsTimerTxt.fixedToCamera=!0,nutsTimerTxt.anchor.setTo(.5,0),nutsTimerTxt.stroke="#000000",nutsTimerTxt.strokeThickness=8,nutsTimerTxt.fill="#ffffff",nutsTimerTxt.visible=!1}function createBG(){bg_back=game.add.tileSprite(0,0,10500,WORLD_HEIGHT,"bg_back"),bg_back.anchor.setTo(0,0),bg_mid=game.add.tileSprite(0,0,10500,WORLD_HEIGHT,"bg_mid"),bg_mid.anchor.setTo(0,0),bg_light=game.add.tileSprite(0,0,10500,WORLD_HEIGHT,"bg_light"),bg_light.anchor.setTo(0,0),bg_front=game.add.tileSprite(0,0,10500,WORLD_HEIGHT,"bg_front"),bg_front.anchor.setTo(0,0)}function updateTime(){total_time+=1;let minutes=String(Math.trunc(total_time/60)).padStart(2,"0"),seconds=String(total_time%60).padStart(2,"0");total_timeHUD.setText(minutes+":"+seconds),3==gameState&&(nutsTimer-=1,nutsTimerTxt.setText(String(nutsTimer).padStart(2,"0")))}function createSign(){sign=game.add.sprite(wallAB.x-150,ground.y,"sign"),sign.anchor.setTo(0,1),rect=game.add.image(sign.x,sign.y-400,"signTextBg"),rect.anchor.setTo(.5,0),rect.alpha=.8,rect.width=640,rect.height=300,signText="Well, well, well... What do we have here? ",signText+="A smartass that thought it was going to be that easy. ",signText+="\nSorry to disappoint you, but you have to jump over the platforms. ",signTextContainer=game.add.text(rect.x-rect.width/2+30,rect.y,signText,{font:"Sniglet",fontSize:"15pt",fill:"#000000"}),signTextContainer.setTextBounds(0,0,rect.width-50,rect.height),signTextContainer.boundsAlignH="center",signTextContainer.boundsAlignV="middle",signTextContainer.wordWrap=!0,signTextContainer.wordWrapWidth=rect.width-50,rect.visible=!1,signText.visible=!1,signTextContainer.visible=!1}function setSquirrel(){squirrel=game.add.sprite(squirrel_initial_x,squirrel_initial_y,"squirrelSpritesheet"),game.physics.arcade.enable(squirrel),squirrel.body.bounce.y=.2,squirrel.body.gravity.y=GRAVITY,squirrel.body.collideWorldBounds=!0,squirrel.anchor.setTo(.5,.5),squirrel.animations.add("walk_right",[0,1,2],10,!0),squirrel.animations.add("walk_left",[3,4,5],10,!0),squirrel.body.setSize(64,38)}function setPlatformsBehind(){platforms=game.add.group(),platforms.enableBody=!0,bgplatformBehind=game.add.group(),wallAB=game.add.sprite(4255,WORLD_HEIGHT,"tree"),wallAB.anchor.setTo(.5,1),game.physics.arcade.enable(wallAB),wallAB.body.immovable=!0,bgtree=bgplatformBehind.create(560,game.world.height-680,"tree"),bgtree.scale.setTo(1,1),bush=bgplatformBehind.create(425,WORLD_HEIGHT-760,"bush"),bush.scale.setTo(.75,.75),bgtree=bgplatformBehind.create(1575,game.world.height-935,"tree"),bgtree.scale.setTo(.77,1.4),bush=bgplatformBehind.create(1405,WORLD_HEIGHT-990,"bush"),bush.scale.setTo(.75,.75),bgtree=bgplatformBehind.create(2310,game.world.height-935,"tree"),bgtree.scale.setTo(.77,1.4),bush=bgplatformBehind.create(2140,WORLD_HEIGHT-990,"bush"),bush.scale.setTo(.75,.75),bgtree=bgplatformBehind.create(3110,game.world.height-935,"tree"),bgtree.scale.setTo(.77,1.4),bush=bgplatformBehind.create(2940,WORLD_HEIGHT-990,"bush"),bush.scale.setTo(.75,.75),bgtree=bgplatformBehind.create(3850,game.world.height-935,"tree"),bgtree.scale.setTo(.77,1.4),bush=bgplatformBehind.create(3680,WORLD_HEIGHT-990,"bush"),bush.scale.setTo(.75,.75),ledge=platforms.create(4355,WORLD_HEIGHT-400,"platform5"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(4715,WORLD_HEIGHT-330,"platform1"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(5105,WORLD_HEIGHT-210,"platform4"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(5205,WORLD_HEIGHT-330,"platform5"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(5655,WORLD_HEIGHT-450,"platform3"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(5985,WORLD_HEIGHT-290,"platform2"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(6575,WORLD_HEIGHT-310,"platform4"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(6375,WORLD_HEIGHT-390,"platform1"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(6885,WORLD_HEIGHT-290,"platform5"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(7445,WORLD_HEIGHT-160,"platform4"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(7455,WORLD_HEIGHT-410,"platform1"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(7715,WORLD_HEIGHT-320,"platform3"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(8255,WORLD_HEIGHT-200,"platform1"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(8405,WORLD_HEIGHT-300,"platform4"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(8555,WORLD_HEIGHT-400,"platform1"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(8855,WORLD_HEIGHT-400,"platform3"),ledge.body.immovable=!0,ledge.body.checkCollision.down=!1}function setPlatformsInfront(){bgplatformInfront=game.add.group(),bgplatformInfront.create(wallAB.x-300,WORLD_HEIGHT-990+100,"bush");let bgtree=bgplatformInfront.create(203,game.world.height-680,"tree"),bush1;bgtree.scale.setTo(.65,1),bgplatformInfront.create(20,WORLD_HEIGHT-760,"bush").scale.setTo(.75,.75);let ledge=platforms.create(300,WORLD_HEIGHT-180,"groundr");ledge.body.immovable=!0,ledge.body.checkCollision.down=!1,ledge=platforms.create(140,WORLD_HEIGHT-300,"groundl"),ledge.body.immovable=!0,ledge=platforms.create(500,WORLD_HEIGHT-300,"groundl"),ledge.body.immovable=!0,ledge=platforms.create(705,WORLD_HEIGHT-420,"groundr"),ledge.body.immovable=!0,ledge=platforms.create(835,WORLD_HEIGHT-540,"groundl"),ledge.body.immovable=!0,bgtree=bgplatformInfront.create(890,game.world.height-935,"tree"),bgtree.scale.setTo(.77,1.4),bush=bgplatformInfront.create(720,WORLD_HEIGHT-990,"bush"),bush.scale.setTo(.75,.75),bgtree=bgplatformInfront.create(1020,game.world.height-610,"tree2"),bgtree.scale.setTo(1.79,1.79),ledge=platforms.create(1005,WORLD_HEIGHT-650,"groundr"),ledge.body.immovable=!0,movingPlat=game.add.sprite(1100,WORLD_HEIGHT-650,"platform4"),game.physics.arcade.enable(movingPlat),movingPlat.body.immovable=!0,movingPlat.body.velocity.x=100,bgtree=bgplatformInfront.create(1938,game.world.height-935,"tree"),bgtree.scale.setTo(.77,1.4),bush=bgplatformInfront.create(1768,WORLD_HEIGHT-990,"bush"),bush.scale.setTo(.75,.75),ledge=platforms.create(1685,WORLD_HEIGHT-450,"groundr"),ledge.body.immovable=!0,ledge=platforms.create(2055,WORLD_HEIGHT-550,"groundr"),ledge.body.immovable=!0,ledge=platforms.create(2427,WORLD_HEIGHT-620,"groundr"),ledge.body.immovable=!0,ledge=platforms.create(2835,WORLD_HEIGHT-460,"groundr"),ledge.body.immovable=!0,bgtree=bgplatformInfront.create(2723,game.world.height-935,"tree"),bgtree.scale.setTo(.77,1.4),bush=bgplatformInfront.create(2553,WORLD_HEIGHT-990,"bush"),bush.scale.setTo(.75,.75),ledge=platforms.create(3225,WORLD_HEIGHT-550,"groundr"),ledge.body.immovable=!0,ledge=platforms.create(3555,WORLD_HEIGHT-620,"groundr"),ledge.body.immovable=!0,bgtree=bgplatformInfront.create(3440,game.world.height-935,"tree"),bgtree.scale.setTo(.77,1.4),bush=bgplatformInfront.create(3270,WORLD_HEIGHT-990,"bush"),bush.scale.setTo(.75,.75),ledge=platforms.create(3965,WORLD_HEIGHT-610,"groundr"),ledge.body.immovable=!0}function updatePlay(){squirrel.x<4355&&gameState===PLATFORMER&&(music||(soundMusic.play(),soundMusic.loop=!0,music=!0)),squirrel.x>4355&&gameState===AVOID_ENEMIES&&(soundMusic.stop(),music2||(soundMusic2.play(),soundMusic2.loop=!0,music2=!0)),squirrel.x>4355&&3===gameState&&(soundMusic2.stop(),music3||(soundMusic3.play(),soundMusic3.loop=!0,music3=!0)),bg_back.x=.5*game.camera.x,bg_mid.x=.425*game.camera.x,bg_light.x=.375*game.camera.x,bg_front.x=.3*game.camera.x,squirrel.x>4355&&gameState===PLATFORMER&&(gameState=AVOID_ENEMIES,squirrel_initial_x=4387,squirrel_initial_y=WORLD_HEIGHT-500,game.camera.deadzone=new Phaser.Rectangle(300,0,200,500)),squirrel.x>9655&&gameState===AVOID_ENEMIES&&(gameState=2,console.log(gameState),console.log(wordsFound),palabraActual=nuevaPalabra(misPalabras),scorePalabras=0,rectBGwords.visible=!0,foundTxt.visible=!0,timeTxt.visible=!0,scoreTxt.visible=!0),squirrel.x>9355&&3===gameState&&(game.camera.deadzone=new Phaser.Rectangle(0,0,0,0),squirrel_initial_x=9455,nutsTimerTxt.visible=!0);let hitPlatform=game.physics.arcade.collide(squirrel,platforms),hitGround=game.physics.arcade.collide(squirrel,ground),hitWall=game.physics.arcade.collide(squirrel,wallAB),hitMovPlat=game.physics.arcade.collide(squirrel,movingPlat);if(2!=gameState){if(squirrel.body.velocity.x=0,cursors.left.isDown&&squirrel.x<9655&&3!=gameState||cursors.left.isDown&&squirrel.x>9725&&3==gameState?(squirrel.body.velocity.x=-300,squirrel.animations.play("walk_left"),toRight=!1):cursors.right.isDown?(squirrel.body.velocity.x=300,squirrel.animations.play("walk_right"),toRight=!0):(squirrel.animations.stop(),squirrel.frame=toRight?7:6),gameState==PLATFORMER&&currentJump>0)cursors.up.isDown&&squirrel.body.touching.down&&(hitPlatform||hitGround||hitWall||hitMovPlat)&&(squirrel.body.velocity.y=-600,squirrel.animations.stop(),squirrel.frame=1,soundJump.play(),currentJump-=1,jumpsHUD.frame=currentJump),0===currentJump&&gameOver(),manageSign(),manageMovingPlat();else if(gameState==AVOID_ENEMIES)cursors.up.isDown&&squirrel.body.touching.down&&(hitPlatform||hitGround||hitWall)&&(squirrel.body.velocity.y=-600,squirrel.animations.stop(),squirrel.frame=1,soundJump.play()),eagles.forEachAlive(eaglesMovement,this),foxes.forEachAlive(foxesMovement,this),game.physics.arcade.overlap(squirrel,eagles,enemyHitsSquirrel,null,this),game.physics.arcade.overlap(squirrel,foxes,enemyHitsSquirrel,null,this);else if(3==gameState&&squirrel.x>9715){if(firsNut&&(fallingNut.y=-50,fallingSpider.y=-50,firsNut=!1),console.log("spider Y:",fallingSpider.y),console.log("nut Y:",fallingNut.y),fallingNut.y<0&&fallingSpider.y<0){console.log(fallingNut.x,fallingNut.y);let ran=Math.random();console.log("ran:",ran),ran<=.3?(fallingSpider.x=getRandomInt(9715,10515-fallingSpider.width),fallingSpider.y=50,fallingSpider.body.velocity.y=300,console.log("genera araña")):(fallingNut.x=getRandomInt(9715,10515-fallingNut.width),fallingNut.y=50,fallingNut.body.velocity.y=300,console.log("generando nut"))}game.physics.arcade.overlap(squirrel,fallingNut,nutOrSpiderCaught,null,this),game.physics.arcade.overlap(squirrel,fallingSpider,nutOrSpiderCaught,null,this),fallingNut.y>600+squirrel.y+fallingNut.height&&(fallingNut.y=-50),fallingSpider.y>600+squirrel.y+fallingSpider.height&&(fallingSpider.y=-50)}}else squirrel.body.velocity.x=0,squirrel.frame=toRight?7:6,showVariables(word,wordsFound,palabraActual,scorePalabras,timeRemaining),timeRemaining<1&&(palabraActual=nuevaPalabra(misPalabras),scorePalabras=Math.max(scorePalabras-100,0),timeRemaining=40,word="")}function manageMovingPlat(){movingPlat.x>=1600?movingPlat.body.velocity.x=-100:movingPlat.x<=1100&&(movingPlat.body.velocity.x=100)}function manageSign(){squirrel.x>sign.x-50&&squirrel.x<sign.x+sign.width+50&&squirrel.y>sign.y-sign.height-50?(rect.visible=!0,signText.visible=!0,signTextContainer.visible=!0):(rect.visible=!1,signText.visible=!1,signTextContainer.visible=!1)}function foxesMovement(fox){let foxHitGround=game.physics.arcade.collide(fox,ground);squirrel.y<WORLD_HEIGHT-300&&fox.x-squirrel.x<300&&squirrel.x<fox.x&&fox.body.touching.down&&foxHitGround?(fox.body.velocity.y=-800,foxCall.play(),fox.animations.play("jump")):fox.body.touching.down&&fox.animations.play("walk")}function eaglesMovement(eagle){eagle.body.y<=WORLD_HEIGHT-600?eagle.body.velocity.y=70:eagle.body.y>=WORLD_HEIGHT-300&&(eagle.body.velocity.y=-70)}function enemyHitsSquirrel(squirrel,enemy){cry.play(),game.camera.flash(16711680,500),EnergyValue=Math.max(0,EnergyValue-1),energyHUD.frame=EnergyValue,squirrel.body.x+=enemy.width+10}function gameOver(){game.camera.resetFX(),game.paused=!0,gameOverImg=game.add.image(game.camera.centerX,game.camera.centerY-80,"gameOver"),gameOverImg.anchor.setTo(.5,.5),replayButton=game.add.button(gameOverImg.x,gameOverImg.y+gameOverImg.height+50,"playButton",restart),replayButton.anchor.setTo(.5,.5),spacebarKey.justDown&&restart()}function restart(){game.paused=!1,squirrel.x=squirrel_initial_x,squirrel.y=squirrel_initial_y,replayButton.kill(),gameOverImg.kill(),gameState==PLATFORMER?(currentJump=MAX_JUMPS,jumpsHUD.frame=currentJump):gameState==AVOID_ENEMIES?(EnergyValue=6,energyHUD.frame=EnergyValue,eagles.callAll("kill"),foxes.callAll("kill")):gameState==AVOID_ENEMIES&&(EnergyValue=6,energyHUD.frame=EnergyValue)}function endGame(){game.state.start("end")}function mostrarImagenPalabra(palabra){2==gameState&&(imagenPalabra.destroy(),console.log(rectBGwords.x),(imagenPalabra=game.add.sprite(rectBGwords.x+rectBGwords.width/2,rectBGwords.y+rectBGwords.height/2,palabra)).anchor.setTo(.5,.5))}function nuevaPalabra(palabras){palabraActual="";let randomIndex=getRandomInt(1,palabras.length)-1;for(;palabras[randomIndex][1];)randomIndex=getRandomInt(1,palabras.length)-1;return mostrarImagenPalabra(palabras[randomIndex][0]),indicePalabra=randomIndex,palabras[indicePalabra][0]}function getRandomInt(min,max){return min=Math.ceil(min),max=Math.floor(max),Math.floor(Math.random()*(max-min+1))+min}function showVariables(word,found,pActual,score,time){wordText.destroy(),wordFoundText.destroy(),scorePalabrasText.destroy(),timerTextPalabras.destroy(),wordText=game.add.text(rectBGwords.x+rectBGwords.width/2,150+rectBGwords.y+rectBGwords.height/2,addSpaces(word,pActual),{fontSize:"20pt",font:font_time}),wordText.anchor.setTo(.5,.5),wordText.stroke="#000000",wordText.strokeThickness=8,wordText.fill="#ffffff",wordFoundText=game.add.text(150,70,found,{fontSize:"20pt",font:font_time}),wordFoundText.fixedToCamera=!0,wordFoundText.anchor.setTo(.5,.5),wordFoundText.stroke="#000000",wordFoundText.strokeThickness=8,wordFoundText.fill="#ffffff",(timerTextPalabras=game.add.text(730,50,String(time).padStart(2,"0"),{fontSize:"20pt",font:font_time})).fixedToCamera=!0,timerTextPalabras.anchor.setTo(.5,0),timerTextPalabras.stroke="#000000",timerTextPalabras.strokeThickness=8,timerTextPalabras.fill="#ffffff",(scorePalabrasText=game.add.text(400,50,score,{fontSize:"20pt",font:font_time})).fixedToCamera=!0,scorePalabrasText.anchor.setTo(.5,0),scorePalabrasText.stroke="#000000",scorePalabrasText.strokeThickness=8,scorePalabrasText.fill="#ffffff"}function keyPress(char){2==gameState&&(word.length!=palabraActual.length&&13!=char.keyCode?word.length<palabraActual.length&&(char.keyCode>=65&&char.keyCode<=90||32==char.keyCode)?word+=char.key:word.length>=0&&8==char.keyCode&&(word=word.slice(0,word.length-1)):(wordFound=palabraIgual(word,palabraActual),wordFound?(wordsFound+=1,timeRemaining>=20?scorePalabras+=200:timeRemaining>0&&(scorePalabras+=150),misPalabras[indicePalabra][1]=!0,correctSF.play()):(wrongSF.play(),scorePalabras=Math.max(scorePalabras-100,0)),word="",timeRemaining=40,wordsFound==misPalabras.length?endPalabras():palabraActual=nuevaPalabra(misPalabras)))}function endPalabras(){rectBGwords.destroy(),imagenPalabra.destroy(),scorePalabrasText.destroy(),wordFoundText.destroy(),wordText.destroy(),timerTextPalabras.destroy(),foundTxt.destroy(),timeTxt.destroy(),scoreTxt.destroy(),game.physics.arcade.enable(fallingNut),game.physics.arcade.enable(fallingSpider),gameState=3}function addSpaces(palabra,palabraCompleta){let palabraEspacios="";for(i of palabra)palabraEspacios+=i+" ";for(i=0;i<palabraCompleta.length-palabra.length;i++)palabraEspacios+=" _";return palabraEspacios}function palabraIgual(word1,word2){return word1==word2}function updateCounter(){timeRemaining>0&&2==gameState&&timeRemaining--}function endNutCatcher(){gameState=4,endGame()}function nutOrSpiderCaught(squirrel,object){object===fallingNut?(fallingNut.y=-50,scoreNut+=1,nutSnd.play()):object===fallingSpider&&(fallingSpider.y=-50,scoreNut=Math.max(scoreNut-1,0),droppedSnd.play(),EnergyValue=Math.max(0,EnergyValue-1)),scoreNutHUD.setText("x"+scoreNut),nutsTimer<1&&endNutCatcher()}let wfConfig={active:function(){startGame()},google:{families:["Sniglet"]},custom:{families:["orange_juice","sketchtica"],urls:["../assets/fonts/orange juice 2.0.ttf","../assets/fonts/Sketchica.ttf"]}};function startGame(){game=new Phaser.Game(800,600,Phaser.CANVAS,"GameStage"),game.state.add("welcome",initialState),game.state.add("about",aboutState),game.state.add("play",playState),game.state.add("end",endState),game.state.start("welcome")}WebFont.load(wfConfig);